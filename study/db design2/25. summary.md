* why hierarchy structure design is required
- rdbms has a flat table structure
- the hierarchy structure of a tree should be stored and retrieved
* adjacency list model
- popular approach for hierarchical structure
- each row reference the parent row(self-referencing)
- pros
  - structure is intuitive
  - addition, deletion, modification are easy
  - storage efficiency is high
- cons
  - a single query for specified depth is hard
* hierarchy structure query issue
- direct parent or child query is easy
- application layer repeating query makes network traffic heavy
- for join or union all, query depth is fixed
* cte and recursive query1
- cte(common table expression) is a temporary table
- recursive cte: start with "with recursive"
- structure
  - anchor case: start point of the recursion
  - recursive case: repeated executed query by reference cte
  - result is combined by union all
- variable depth query is possible
* cte and recursive query2
- usage: all ancestors query, specific depth query, path string generation
- pros: variable depth is supported, a single query, standard sql, readability is high
- practice example: product count aggregation by category
* closure table model1
- concept: all ancestor-descendant relationships is calculated and stored
- structure
  - node table: real data 
  - path table: ancestor, descendant, depth
- characteristics: read performance is optimized
- query: simple join without recursion
* closure table model2
- usage: direct descendant query, specific depth query
- data manipulation
  - in addition: own path, paths to all ancestors
  - in deletion/modification:: all related paths are updated
- comparison and selection
  - adjacency list + cte: simple implementation, almost cases
  - closure table: heavy read traffic, huge data, rare modification  