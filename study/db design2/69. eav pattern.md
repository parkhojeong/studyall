* entity-attribute-value

traditional table structure
- attribute is a column of a table
- the new attribute needs a new column of table
eav structure
- attribute is a row of table
```sql
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS furniture;
DROP TABLE IF EXISTS book;
DROP TABLE IF EXISTS clothing;
DROP TABLE IF EXISTS electronics;

DROP TABLE IF EXISTS product_attribute;
DROP TABLE IF EXISTS product;

-- Entity: 상품
CREATE TABLE product (
  product_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(200) NOT NULL,
  created_at DATETIME NOT NULL
);

-- Attribute-Value: 상품의 속성과 값
CREATE TABLE product_attribute (
  attribute_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  product_id BIGINT NOT NULL,
  attr_name VARCHAR(100) NOT NULL,
  attr_value VARCHAR(500),
  FOREIGN KEY (product_id) REFERENCES product(product_id)
);

-- 데이터 입력
INSERT INTO product (product_id, name, created_at) VALUES
(1, 'Galaxy S24', NOW()),
(2, 'iPhone 15', NOW());

INSERT INTO product_attribute (product_id, attr_name, attr_value) VALUES
(1, 'screen_size', '6.2인치'),
(1, 'battery_capacity', '4000mAh'),
(1, 'camera_pixels', '50MP'),
(1, 'ram', '8GB'),
(1, 'storage', '256GB'),
(2, 'screen_size', '6.1인치'),
(2, 'battery_capacity', '3349mAh'),
(2, 'camera_pixels', '48MP'),
(2, 'ram', '6GB'),
(2, 'storage', '128GB');
```
eav 3 factors
- entity: subject that has attribute(ex. product, user, order)
- attribute: characters name that entity has(ex. screen_size, battery_capacity)
- value: real value of attribute(ex. 6.2inch, 4000mAh)

eav main characters
- adding new attribute is free
```sql
INSERT INTO product_attribute (product_id, attr_name, attr_value) VALUES
(1, 'supports_5g', 'Y'),
(2, 'supports_5g', 'Y');
```

- entity has different attributes
```sql
INSERT INTO product_attribute (product_id, attr_name, attr_value) VALUES
(1, 's_pen_support', 'N'),
(1, 'samsung_dex', 'Y');
```

query to galaxy s24 attribute
```sql
SELECT p.name, pa.attr_name, pa.attr_value
FROM product p
         JOIN product_attribute pa ON p.product_id = pa.product_id
WHERE p.product_id = 1
ORDER BY pa.attr_name;
```
+----------+----------------+----------+
|name      |attr_name       |attr_value|
+----------+----------------+----------+
|Galaxy S24|battery_capacity|4000mAh   |
|Galaxy S24|camera_pixels   |50MP      |
|Galaxy S24|ram             |8GB       |
|Galaxy S24|s_pen_support   |N         |
|Galaxy S24|samsung_dex     |Y         |
|Galaxy S24|screen_size     |6.2인치     |
|Galaxy S24|storage         |256GB     |
|Galaxy S24|supports_5g     |Y         |
+----------+----------------+----------+


query to iphone 15 attribute
```sql
SELECT p.name, pa.attr_name, pa.attr_value
FROM product p
JOIN product_attribute pa ON p.product_id = pa.product_id
WHERE p.product_id = 2
ORDER BY pa.attr_name;
```
+---------+----------------+----------+
|name     |attr_name       |attr_value|
+---------+----------------+----------+
|iPhone 15|battery_capacity|3349mAh   |
|iPhone 15|camera_pixels   |48MP      |
|iPhone 15|ram             |6GB       |
|iPhone 15|screen_size     |6.1인치     |
|iPhone 15|storage         |128GB     |
|iPhone 15|supports_5g     |Y         |
+---------+----------------+----------+
