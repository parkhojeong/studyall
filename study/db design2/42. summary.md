| method                                            | previous value store | point-in-time query | impl difficulty | size     | pratice usage frequency |
|---------------------------------------------------|----------------------|---------------------|-----------------|----------|-------------------------|
| basic tracking column(created_, updated_)         | X                    | X                   | very easy       | very low | high(default)           |
| previous value column                             | only one             | X                   | easy            | low      | low                     |
| current table + is_current                        | O                    | hard                | normal          | high     | low                     |
| current table + valid_from/to                     | O                    | easy                | normal          | high     | normal                  |
| all column snapshot history table                 | O                    | hard                | normal          | high     | very high               |
| all column snapshot history table + valid_from/to | O                    | easy                | normal          | high     | very high               |
| column unit change log                            | O                    | very hard           | hihgh           | low      | low                     |
| common history table                              | O                    | hard                | normal          | high     | normal(for support)     |

practice recommendation combination
basic configuration
1. all table: basic change tracking column(created_at, created_by, updated_at, updated_by, etc)
2. important table: dedicated history table(all column snapshot)
3. all system: common history table(optional)

data that need a history table
- product info: product price, discount rate
- status info: order status, member grade
- amount/quantity: account balance, point, stock quantity
- contract/agreement: contract condition, agreement content
- setting: user setting, system setting
- permission: user permission, role

data that doesn't need a history table
- log data
- temporary data: session, cache
- master data that changes rarely: code table(country code)
- large content: product description, board content(size issue)

practice check list
- basic tracking column is added? use by default
  - created_at, created_by, updated_at, updated_by
- if yes to any question, consider dedicated history table
1. data change history is important to business?
- price change, status change, amount change. history is important 
2. past value is queried?
- you must reply "yesterday price is how much"?
3. point-in-time data is needed?
- you must reply "what was the stock quantity on 2020-01-01"?
4. audit requirement exists?
- required in finance, medical industry

* summary
previous value stored in column
- in existing table, add column like previous_price
- simple impl
- if change is rare, it can be good
history management in current table - start
- when data upate, insert instead of update
- is_current column is added
- a point-in-time query is possible
- size can grow very large
valid period
- valid_from, valid_to column is added
- easy to query
- update and insert can be atomic 
total row snapshot table - start
- separate table, table_history
- in history table, created_at, history_created_at is added
total row snapshot table - caution
- first creation row is inserted
total row snapshot table - limit
- diff is hard to calculate
column unit change log
- diff is easy to calculate
- type info is lost
- when in large size, only specific column can be tracked
common history table
- table_name, record_id, old_data, new_data is stored
- for activity audit or debugging
- json parsing is required
data change history design summary
- db store business data, system log store to file
- audit_log is business data, regularly archived and deleted from original table
- default strategy is total row snapshot