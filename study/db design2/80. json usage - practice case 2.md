case3: user settings
requirement: user can have multiple settings

schema design
```sql
DROP TABLE IF EXISTS user_settings;

CREATE TABLE user_settings (
  user_id BIGINT PRIMARY KEY,
  username VARCHAR(100) NOT NULL,
  settings JSON,
  created_at DATETIME NOT NULL DEFAULT NOW(),
  updated_at DATETIME NOT NULL DEFAULT NOW() ON UPDATE NOW()
);
```

data insertion
```sql
INSERT INTO user_settings (user_id, username, settings) VALUES
(1, 'kim_user', JSON_OBJECT(
  'notifications', JSON_OBJECT(
    'email', true,
    'push', true,
    'sms', false,
    'marketing', false,
    'frequency', 'realtime'
  ),
  'display', JSON_OBJECT(
    'theme', 'dark',
    'language', 'ko',
    'timezone', 'Asia/Seoul',
    'items_per_page', 20
  ),
  'privacy', JSON_OBJECT(
    'profile_visible', true,
    'show_online_status', false,
    'allow_friend_requests', true
  )
)),
(2, 'lee_user', JSON_OBJECT(
  'notifications', JSON_OBJECT(
    'email', true,
    'push', false,
    'sms', true,
    'marketing', true,
    'frequency', 'daily'
  ),
  'display', JSON_OBJECT(
    'theme', 'light',
    'language', 'en',
    'timezone', 'America/New_York',
    'items_per_page', 50
  ),
  'privacy', JSON_OBJECT(
    'profile_visible', false,
    'show_online_status', false,
    'allow_friend_requests', false
  )
));
```

case 4: log and event data
user activity log, system event log

schema design
```sql
DROP TABLE IF EXISTS event_log;

CREATE TABLE event_log (
  log_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  event_type VARCHAR(100) NOT NULL,
  user_id BIGINT,
  event_data JSON NOT NULL,
  created_at DATETIME NOT NULL DEFAULT NOW(),
  INDEX idx_event_type (event_type),
  INDEX idx_user_id (user_id),
  INDEX idx_created_at (created_at)
);
```

data insertion
```sql
-- 페이지 조회 이벤트
INSERT INTO event_log (event_type, user_id, event_data) VALUES
('page_view', 1, JSON_OBJECT(
  'page', '/products/phone/galaxy-s24',
  'referrer', 'https://google.com',
  'duration_seconds', 45,
  'device', JSON_OBJECT('type', 'mobile', 'os', 'iOS', 'browser', 'Safari')
));

-- 검색 이벤트
INSERT INTO event_log (event_type, user_id, event_data) VALUES
('search', 1, JSON_OBJECT(
  'query', '갤럭시 케이스',
  'filters', JSON_OBJECT('category', '액세서리', 'price_max', 50000),
  'results_count', 42,
  'clicked_position', 3
));

-- 장바구니 추가 이벤트
INSERT INTO event_log (event_type, user_id, event_data) VALUES
('add_to_cart', 1, JSON_OBJECT(
  'product_id', 101,
  'product_name', '갤럭시 S24',
  'quantity', 1,
  'price', 1200000,
  'cart_total', 1200000
));

-- 구매 완료 이벤트
INSERT INTO event_log (event_type, user_id, event_data) VALUES
('purchase', 1, JSON_OBJECT(
  'order_id', 10001,
  'items_count', 2,
  'total_amount', 1270000,
  'payment_method', 'card',
  'coupon_used', 'WELCOME10'
));

-- 시스템 에러 이벤트
INSERT INTO event_log (event_type, user_id, event_data) VALUES
('error', NULL, JSON_OBJECT(
  'error_code', 'DB_ERROR',
  'message', 'Failed to connect to database',
  'server', 'db1',
  'stack_trace', '...',
  'level', 'critical'
));
```

* summary
popular use cases
- product attributes management by category
- product options and stock management(json_table)
- i18n support
- user settings
- order info snapshot log
- log and event data
core techniques
- json_table: json array to table
- json_object, json_array: json creation
- json_set, json_insert: partial update
- nested path access: $.parent.child.value