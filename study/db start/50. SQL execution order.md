* SQL execution order
- from order_stat, group by customer_name, sum(quantity*price) >= 400,000
- select customer_name

```sql
select
    customer_name,
    SUM(price*quantity) as total_purchase
from order_stat
where total_purchase >= 400000 -- use alias
group by customer_name;
-- Error Code: 1054. Unknown column 'total_purchase' in 'where clause'
```

* SQL query logical execution order
1. FROM: select table
2. WHERE: filter row
3. GROUP BY: group row
4. HAVING: filter group
5. SELECT: output column
6. ORDER BY: sort row
  - can use alias in select
7. LIMIT: limit row

* SQL logical execution order, physical execution order
- user should write SQL in logical order
- db engine optimize SQL

* practical example execution order
- problem
  - from order_stat, order before 2025-05-14, group by customer_name, filter count >= 2
  - select customer_name, total price, order by total price desc, limit 1
  - total price: sum(price*quantity)
```sql
select -- stage 5
    customer_name, 
    SUM(price*quantity) as total_purchase 
from order_stat -- stage 1
where order_date < '2025-05-14' -- stage 2
group by customer_name -- stage 3
having COUNT(*) >= 2 -- stage 4
order by total_purchase desc -- stage 6
limit 1; -- stage 7
```