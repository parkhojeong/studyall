* problem and solution

* problem1
- order_stat
- select 
  - total order count
    - alias total order count 
  - order count that category is not null
    - alias count having category  
```sql
select
    COUNT(*) as total_order_count,
    COUNT(category) as count_having_category
from 
    order_stat;

```

* problem2
- from order_stat
- select
  - total order price
  - average order price(price per 1 order)
  - max order price
  - min order price
```sql
select
    SUM(price*quantity) as total_order_price,
    AVG(price*quantity) as average_order_price,
    MAX(price) as max_order_price,
    MIN(price) as min_order_price
from 
    order_stat;
```

* problem3: analyze results group by category
- from order_stat
- group by category
- select
  - category
  - total quantity
  - total (price*quantity)
- order by total (price*quantity)
```sql
select
    category,
    SUM(quantity) as total_quantity,
    SUM(price*quantity) as `total price`
from 
    order_stat
group by category
order by `total price` desc; -- use backtick(`)
```

* problem4: analyze order statistics group by customer
- from order_stat
- group by customer_name
- select
  - count(*) `total order count`
  - sum(quantity) `total order quantity`
- order by `total order count` desc, `total order quantity` desc
```sql 
select
    customer_name,
    COUNT(*) as `total order count`,
    SUM(quantity) as `total order quantity`
from 
    order_stat
group by customer_name
order by `total order count` desc, `total order quantity` desc;
```
  
* problem5: filter vip customer
- from order_stat
- group by customer_name
- having sum(quantity*price) >= 400,000
- select customer_name, sum(quantity*price)
- order by sum(quantity*price) desc

```sql
select
    customer_name,
    SUM(quantity*price) as `total order price`
from 
    order_stat
group by customer_name
having SUM(quantity*price) >= 400000
order by `total order price` desc;
```

* problem6: important customer group by complex condition
- from order_stat
- category!='도서',
- group by customer_name
- having count(*) >= 2
- select customer_name, count(*), SUM(quantity*price)
- SUM(quantity*price) desc
```sql
select customer_name, count(*), SUM(quantity*price)
from order_stat
where category!='도서' or category is null -- null!='도서' -> always false 
group by customer_name
having count(*) >= 2
order by SUM(quantity*price) desc;
```