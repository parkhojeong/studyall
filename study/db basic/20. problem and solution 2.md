* problem and solution 2

* problem1: find report of specific manage
- employees self join, direct report of '최과장'
- name, employee_id
```sql
select 
	e.employee_id, 
	e.name, 
	e.manager_id, 
	m.name as manager_name
from employees e
join employees m on e.manager_id = m.employee_id
where m.name = '최과장';
```

* problem2: add materials to combination of product option
- create materials table having Cotton, Silk
- sizes, colors, materials - cross join
- create product_name-size-color-material format by concat()
```sql
create table materials(
    material varchar(20) primary key
);
insert into materials values('Cotton'), ('Silk');

select
    concat('basic-shirt','-', s.size,'-', c.color,'-', m.material),
    s.size,
    c.color,
    m.material
from sizes s
         cross join colors c
         cross join materials m;
```

* problem3: specific user order detail
- use users, orders, products
- user '네이트' order detail
- select product_name, order_date, quantity
- order by order_date desc
```sql
select
    u.name as customer_name,
    p.name as product_name,
    o.order_date as order_date,
    o.quantity as quantity
from users u
         join orders o on u.user_id = o.user_id
         join products p on o.product_id = p.product_id
where u.name = '네이트'
order by o.order_date desc;
```

- other approach: start with order table
```sql
select 
	*
from orders o
    join users u on o.user_id = u.user_id
    join products p on o.product_id = p.product_id;
```

* problem4: calculate total order amount in '서울' address
- join and aggregate
- address = '서울', group by user, total_spent(=sum(price*quantity))
- order by total_spent desc
```sql
select 
    u.name,
    sum(p.price*o.quantity) as total_spent
from orders o
    join users u on o.user_id = u.user_id
    join products p on o.product_id = p.product_id
where u.address LIKE '서울%'
group by u.name
order by total_spent desc;
```