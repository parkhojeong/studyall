* correlated subquery2

* requirement: show a product that has been ordered once or more.

* solution with IN
- 1. select distinct product_id from orders;
- 2. select * from products where product_id in (1);
```sql
select *
from products p
where p.product_id in (select distinct product_id from orders);
```

* solution with EXISTS
- IN performance issue if large data from subquery
- EXISTS: return if one row is found
```sql
select product_id, name, price 
from products p 
where exists (
  select 1
  from orders o
  where o.product_id = p.product_id
);
```

* practice: IN vs EXISTS
- execution flow
  - IN: subquery execution -> main query execution
  - EXISTS: subquery execution per each row in main query
- characteristics
  - IN: subquery execution once. if small data, fast
  - EXISTS: if sub query is large data, efficient
- optimization
  - IN: orders table may scan full
  - EXISTS: end scan if row is found for condition
- conclusion: if subquery target table is large, EXISTS can be better

* NOT EXISTS: return if no row is found
```sql
select product_id, name, price 
from products p 
where not exists (
  select 1
  from orders o
  where o.product_id = p.product_id
);
```

* correlated subquery and performance
- repeat for row count, be careful with performance
- rewrite it to join if possible(especially, LEFT JOIN and GROUP BY)