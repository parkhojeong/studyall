* most important 2 things in jpa
- object relational mapping
- persistence context

* entityManagerFactory and entityManager
- entityManagerFactory create entityManager per user request
- entityManager use connection in the connection pool

* persistence context
- definition: environment for entity persistence storage
- logical concept
- it can be accessed by an entity manager

* entity manager and persistence context relationship
- in j2se env, 1:1
- in j2ee or spring env, n:1 

* Entity Lifecycle
```
                          +-----------------------+
                          |       Detached        |
                          +-----------------------+
                                 ^          |
    detach() / clear() / close() |          | merge() 
                                 |          v
 +-----------+            +-----------------------+  flush()  +-----------------------+
 |    New    | ---------> |       Managed         | --------> |                       |
 +-----------+  persist() +-----------------------+ <-------- |          DB           |
                                |      ^             find()   |                       |
                                |      |             JPQL     |                       |
                       remove() |      | persist()            |                       |
                                v      |                      |                       |
                          +-----------------------+           |                       |
                          |       Removed         |           |                       |
                          +-----------------------+ --------> |                       |
                                                    flush()   +-----------------------+
```
- new/transient: not related to persistence context
- managed: managed in persistence context
- detached: detached from persistence context
- removed: removed status in persistence context
- flush(): write to a database

* persistence context pros
- 1st cache
- identity guarantee
- transactional write-behind
- dirt checking
- lazy loading